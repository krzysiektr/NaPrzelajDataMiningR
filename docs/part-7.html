<!DOCTYPE html>
<html  lang="pl">

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Rozdział 7 Przykład analizy szeregów czasowych | Na przełaj przez Data Mining z pakietem R</title>
  <meta name="description" content="Zbiór przykładów użycia wybranych funkcji statystycznych i Data Mining dostępnych w programie R.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Rozdział 7 Przykład analizy szeregów czasowych | Na przełaj przez Data Mining z pakietem R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Zbiór przykładów użycia wybranych funkcji statystycznych i Data Mining dostępnych w programie R." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Rozdział 7 Przykład analizy szeregów czasowych | Na przełaj przez Data Mining z pakietem R" />
  
  <meta name="twitter:description" content="Zbiór przykładów użycia wybranych funkcji statystycznych i Data Mining dostępnych w programie R." />
  

<meta name="author" content="Przemysław Biecek, Krzysztof Trajkowski">


<meta name="date" content="2019-04-12">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="part-6.html">
<link rel="next" href="part-8.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Na przełaj przez Data Mining<br/> z pakietem R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Kilka słów zamiast wstępu</a></li>
<li class="chapter" data-level="2" data-path="part-2.html"><a href="part-2.html"><i class="fa fa-check"></i><b>2</b> Redukcja wymiaru</a><ul>
<li class="chapter" data-level="2.1" data-path="part-2.html"><a href="part-2.html#part_21"><i class="fa fa-check"></i><b>2.1</b> Analiza składowych głównych (PCA, ang. Principal Components Analysis)</a></li>
<li class="chapter" data-level="2.2" data-path="part-2.html"><a href="part-2.html#part_22"><i class="fa fa-check"></i><b>2.2</b> Nieliniowe skalowanie wielowymiarowe (Sammon Mapping)</a></li>
<li class="chapter" data-level="2.3" data-path="part-2.html"><a href="part-2.html#part_23"><i class="fa fa-check"></i><b>2.3</b> Skalowanie wielowymiarowe Kruskalla (MDS, ang. Multidimensional Scaling)</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="part-3.html"><a href="part-3.html"><i class="fa fa-check"></i><b>3</b> Analiza skupień</a><ul>
<li class="chapter" data-level="3.1" data-path="part-3.html"><a href="part-3.html#part_31"><i class="fa fa-check"></i><b>3.1</b> Metoda k-średnich</a></li>
<li class="chapter" data-level="3.2" data-path="part-3.html"><a href="part-3.html#part_32"><i class="fa fa-check"></i><b>3.2</b> Metoda grupowania wokół centroidów (PAM, ang. Partitioning Around Medoids)</a></li>
<li class="chapter" data-level="3.3" data-path="part-3.html"><a href="part-3.html#part_33"><i class="fa fa-check"></i><b>3.3</b> Metoda aglomeracyjnego klastrowania hierarchicznego</a></li>
<li class="chapter" data-level="3.4" data-path="part-3.html"><a href="part-3.html#part_34"><i class="fa fa-check"></i><b>3.4</b> Ile skupień wybrać?</a></li>
<li class="chapter" data-level="3.5" data-path="part-3.html"><a href="part-3.html#part_35"><i class="fa fa-check"></i><b>3.5</b> Inne metody analizy skupień</a></li>
<li class="chapter" data-level="3.6" data-path="part-3.html"><a href="part-3.html#part_36"><i class="fa fa-check"></i><b>3.6</b> Case study</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="part-4.html"><a href="part-4.html"><i class="fa fa-check"></i><b>4</b> Analiza dyskryminacji</a><ul>
<li class="chapter" data-level="4.1" data-path="part-4.html"><a href="part-4.html#part_41"><i class="fa fa-check"></i><b>4.1</b> Dyskryminacja liniowa i kwadratowa</a></li>
<li class="chapter" data-level="4.2" data-path="part-4.html"><a href="part-4.html#part_42"><i class="fa fa-check"></i><b>4.2</b> Metoda najbliższych sąsiadów</a></li>
<li class="chapter" data-level="4.3" data-path="part-4.html"><a href="part-4.html#part_43"><i class="fa fa-check"></i><b>4.3</b> Naiwny klasyfikator Bayesowski</a></li>
<li class="chapter" data-level="4.4" data-path="part-4.html"><a href="part-4.html#part_44"><i class="fa fa-check"></i><b>4.4</b> Drzewa decyzyjne</a></li>
<li class="chapter" data-level="4.5" data-path="part-4.html"><a href="part-4.html#part_45"><i class="fa fa-check"></i><b>4.5</b> Lasy losowe</a></li>
<li class="chapter" data-level="4.6" data-path="part-4.html"><a href="part-4.html#part_46"><i class="fa fa-check"></i><b>4.6</b> Inne klasyfikatory</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="part-5.html"><a href="part-5.html"><i class="fa fa-check"></i><b>5</b> Analiza kanoniczna</a><ul>
<li class="chapter" data-level="5.1" data-path="part-5.html"><a href="part-5.html#part_51"><i class="fa fa-check"></i><b>5.1</b> Problem</a></li>
<li class="chapter" data-level="5.2" data-path="part-5.html"><a href="part-5.html#part_52"><i class="fa fa-check"></i><b>5.2</b> Rozwiązanie</a></li>
<li class="chapter" data-level="5.3" data-path="part-5.html"><a href="part-5.html#part_53"><i class="fa fa-check"></i><b>5.3</b> Założenia</a></li>
<li class="chapter" data-level="5.4" data-path="part-5.html"><a href="part-5.html#part_54"><i class="fa fa-check"></i><b>5.4</b> Jak to zrobić w R</a></li>
<li class="chapter" data-level="5.5" data-path="part-5.html"><a href="part-5.html#part_55"><i class="fa fa-check"></i><b>5.5</b> Przykładowe wyniki</a></li>
<li class="chapter" data-level="5.6" data-path="part-5.html"><a href="part-5.html#part_56"><i class="fa fa-check"></i><b>5.6</b> Studium przypadku</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="part-6.html"><a href="part-6.html"><i class="fa fa-check"></i><b>6</b> Analiza korespondencji (odpowiedniości)</a><ul>
<li class="chapter" data-level="6.1" data-path="part-6.html"><a href="part-6.html#part_61"><i class="fa fa-check"></i><b>6.1</b> Problem</a></li>
<li class="chapter" data-level="6.2" data-path="part-6.html"><a href="part-6.html#part_62"><i class="fa fa-check"></i><b>6.2</b> Rozwiązanie</a></li>
<li class="chapter" data-level="6.3" data-path="part-6.html"><a href="part-6.html#part_63"><i class="fa fa-check"></i><b>6.3</b> Jak to zrobić w R?</a></li>
<li class="chapter" data-level="6.4" data-path="part-6.html"><a href="part-6.html#part_64"><i class="fa fa-check"></i><b>6.4</b> Studium przypadku</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="part-7.html"><a href="part-7.html"><i class="fa fa-check"></i><b>7</b> Przykład analizy szeregów czasowych</a><ul>
<li class="chapter" data-level="7.1" data-path="part-7.html"><a href="part-7.html#part_71"><i class="fa fa-check"></i><b>7.1</b> Wprowadzenie</a></li>
<li class="chapter" data-level="7.2" data-path="part-7.html"><a href="part-7.html#part_72"><i class="fa fa-check"></i><b>7.2</b> Identyfikacja trendu i sezonowości</a><ul>
<li class="chapter" data-level="7.2.1" data-path="part-7.html"><a href="part-7.html#part_721"><i class="fa fa-check"></i><b>7.2.1</b> Analiza wariancji - ANOVA</a></li>
<li class="chapter" data-level="7.2.2" data-path="part-7.html"><a href="part-7.html#part_722"><i class="fa fa-check"></i><b>7.2.2</b> Funkcja autokorelacji - ACF</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="part-7.html"><a href="part-7.html#part_73"><i class="fa fa-check"></i><b>7.3</b> Modele autoregresyjne ARIMA</a><ul>
<li class="chapter" data-level="7.3.1" data-path="part-7.html"><a href="part-7.html#part_731"><i class="fa fa-check"></i><b>7.3.1</b> Estymacja</a></li>
<li class="chapter" data-level="7.3.2" data-path="part-7.html"><a href="part-7.html#part_732"><i class="fa fa-check"></i><b>7.3.2</b> Weryfikacja</a></li>
<li class="chapter" data-level="7.3.3" data-path="part-7.html"><a href="part-7.html#part_733"><i class="fa fa-check"></i><b>7.3.3</b> Prognozowanie</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="part-7.html"><a href="part-7.html#part_74"><i class="fa fa-check"></i><b>7.4</b> Modele adaptacyjne</a><ul>
<li class="chapter" data-level="7.4.1" data-path="part-7.html"><a href="part-7.html#part_741"><i class="fa fa-check"></i><b>7.4.1</b> Estymacja</a></li>
<li class="chapter" data-level="7.4.2" data-path="part-7.html"><a href="part-7.html#part_742"><i class="fa fa-check"></i><b>7.4.2</b> Prognozowanie</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="part-8.html"><a href="part-8.html"><i class="fa fa-check"></i><b>8</b> Przykład analizy tabel wielodzielczych</a><ul>
<li class="chapter" data-level="8.1" data-path="part-8.html"><a href="part-8.html#part_81"><i class="fa fa-check"></i><b>8.1</b> Wprowadzenie</a></li>
<li class="chapter" data-level="8.2" data-path="part-8.html"><a href="part-8.html#part_82"><i class="fa fa-check"></i><b>8.2</b> Test chi-kwadrat</a></li>
<li class="chapter" data-level="8.3" data-path="part-8.html"><a href="part-8.html#part_83"><i class="fa fa-check"></i><b>8.3</b> Model logitowy</a></li>
<li class="chapter" data-level="8.4" data-path="part-8.html"><a href="part-8.html#part_84"><i class="fa fa-check"></i><b>8.4</b> Model logitowy</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="part-9.html"><a href="part-9.html"><i class="fa fa-check"></i><b>9</b> Przykład badania rozkładu stopy zwrotu z akcji</a><ul>
<li class="chapter" data-level="9.1" data-path="part-9.html"><a href="part-9.html#part_9.1"><i class="fa fa-check"></i><b>9.1</b> Wprowadzenie</a></li>
<li class="chapter" data-level="9.2" data-path="part-9.html"><a href="part-9.html#part_9.2"><i class="fa fa-check"></i><b>9.2</b> Statystyki opisowe</a></li>
<li class="chapter" data-level="9.3" data-path="part-9.html"><a href="part-9.html#part_9.3"><i class="fa fa-check"></i><b>9.3</b> Rozkład normalny</a></li>
<li class="chapter" data-level="9.4" data-path="part-9.html"><a href="part-9.html#part_9.4"><i class="fa fa-check"></i><b>9.4</b> Rozkład Cauchy’ego</a></li>
<li class="chapter" data-level="9.5" data-path="part-9.html"><a href="part-9.html#part_9.5"><i class="fa fa-check"></i><b>9.5</b> Rozkład Laplace’a</a></li>
<li class="chapter" data-level="9.6" data-path="part-9.html"><a href="part-9.html#part_9.6"><i class="fa fa-check"></i><b>9.6</b> Rozkład Stabilny</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="part-10.html"><a href="part-10.html"><i class="fa fa-check"></i><b>10</b> Przykład budowy dynamicznego modelu liniowego</a><ul>
<li class="chapter" data-level="10.1" data-path="part-10.html"><a href="part-10.html#part_10.1"><i class="fa fa-check"></i><b>10.1</b> Wprowadzenie</a></li>
<li class="chapter" data-level="10.2" data-path="part-10.html"><a href="part-10.html#part_10.2"><i class="fa fa-check"></i><b>10.2</b> Badanie wewnętrznej struktury procesu</a><ul>
<li class="chapter" data-level="10.2.1" data-path="part-10.html"><a href="part-10.html#part_10.2.1"><i class="fa fa-check"></i><b>10.2.1</b> Trend</a></li>
<li class="chapter" data-level="10.2.2" data-path="part-10.html"><a href="part-10.html#part_10.2.2"><i class="fa fa-check"></i><b>10.2.2</b> Sezonowość</a></li>
<li class="chapter" data-level="10.2.3" data-path="part-10.html"><a href="part-10.html#part_10.2.3"><i class="fa fa-check"></i><b>10.2.3</b> Stopień autoregresji – funkcja PACF</a></li>
<li class="chapter" data-level="10.2.4" data-path="part-10.html"><a href="part-10.html#part_10.2.4"><i class="fa fa-check"></i><b>10.2.4</b> Stopień integracji – test ADF/PP</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="part-10.html"><a href="part-10.html#part_10.3"><i class="fa fa-check"></i><b>10.3</b> Weryfikacja modelu</a><ul>
<li class="chapter" data-level="10.3.1" data-path="part-10.html"><a href="part-10.html#part_10.3.1"><i class="fa fa-check"></i><b>10.3.1</b> Estymacja dynamicznego modelu liniowego</a></li>
<li class="chapter" data-level="10.3.2" data-path="part-10.html"><a href="part-10.html#part_10.3.2"><i class="fa fa-check"></i><b>10.3.2</b> Ocena jakości modelu</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="part-10.html"><a href="part-10.html#part_10.4"><i class="fa fa-check"></i><b>10.4</b> Diagnostyka modelu</a><ul>
<li class="chapter" data-level="10.4.1" data-path="part-10.html"><a href="part-10.html#part_10.4.1"><i class="fa fa-check"></i><b>10.4.1</b> Normalność procesu resztowego</a></li>
<li class="chapter" data-level="10.4.2" data-path="part-10.html"><a href="part-10.html#part_10.4.2"><i class="fa fa-check"></i><b>10.4.2</b> Autokorelacja procesu resztowego</a></li>
<li class="chapter" data-level="10.4.3" data-path="part-10.html"><a href="part-10.html#part_10.4.3"><i class="fa fa-check"></i><b>10.4.3</b> Heteroskedastyczność procesu resztowego</a></li>
<li class="chapter" data-level="10.4.4" data-path="part-10.html"><a href="part-10.html#part_10.4.4"><i class="fa fa-check"></i><b>10.4.4</b> Stabilność parametrów modelu</a></li>
<li class="chapter" data-level="10.4.5" data-path="part-10.html"><a href="part-10.html#part_10.4.5"><i class="fa fa-check"></i><b>10.4.5</b> Postać analityczna modelu</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="part-11.html"><a href="part-11.html"><i class="fa fa-check"></i><b>11</b> Przegląd wybranych testów statystycznych</a><ul>
<li class="chapter" data-level="11.1" data-path="part-11.html"><a href="part-11.html#part_11.1"><i class="fa fa-check"></i><b>11.1</b> Testy normalności</a></li>
<li class="chapter" data-level="11.2" data-path="part-11.html"><a href="part-11.html#part_11.2"><i class="fa fa-check"></i><b>11.2</b> Testy asymptotyczne</a></li>
<li class="chapter" data-level="11.3" data-path="part-11.html"><a href="part-11.html#part_11.3"><i class="fa fa-check"></i><b>11.3</b> Testy dla proporcji</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="part-12.html"><a href="part-12.html"><i class="fa fa-check"></i><b>12</b> Przykład analizy liczby przestępstw w Polsce w 2009 r.</a><ul>
<li class="chapter" data-level="12.1" data-path="part-12.html"><a href="part-12.html#part_12.1"><i class="fa fa-check"></i><b>12.1</b> Wprowadzenie</a></li>
<li class="chapter" data-level="12.2" data-path="part-12.html"><a href="part-12.html#part_12.2"><i class="fa fa-check"></i><b>12.2</b> Mapy</a></li>
<li class="chapter" data-level="12.3" data-path="part-12.html"><a href="part-12.html#part_12.3"><i class="fa fa-check"></i><b>12.3</b> Analiza wariancji</a></li>
<li class="chapter" data-level="12.4" data-path="part-12.html"><a href="part-12.html#part_12.4"><i class="fa fa-check"></i><b>12.4</b> Modele dla liczebności</a></li>
<li class="chapter" data-level="12.5" data-path="part-12.html"><a href="part-12.html#part_12.5"><i class="fa fa-check"></i><b>12.5</b> Modele dla częstości</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="part-13.html"><a href="part-13.html"><i class="fa fa-check"></i><b>13</b> Modele regresji</a><ul>
<li class="chapter" data-level="13.1" data-path="part-13.html"><a href="part-13.html#part_13.1"><i class="fa fa-check"></i><b>13.1</b> Wprowadzenie</a></li>
<li class="chapter" data-level="13.2" data-path="part-13.html"><a href="part-13.html#part_13.2"><i class="fa fa-check"></i><b>13.2</b> Estymacja modelu liniowego</a><ul>
<li class="chapter" data-level="13.2.1" data-path="part-13.html"><a href="part-13.html#part_13.2.1"><i class="fa fa-check"></i><b>13.2.1</b> Metoda najmniejszych kwadratów</a></li>
<li class="chapter" data-level="13.2.2" data-path="part-13.html"><a href="part-13.html#part_13.2.2"><i class="fa fa-check"></i><b>13.2.2</b> Poprawność specyfikacji modelu</a></li>
<li class="chapter" data-level="13.2.3" data-path="part-13.html"><a href="part-13.html#part_13.2.3"><i class="fa fa-check"></i><b>13.2.3</b> Normalność</a></li>
<li class="chapter" data-level="13.2.4" data-path="part-13.html"><a href="part-13.html#part_13.2.4"><i class="fa fa-check"></i><b>13.2.4</b> Heteroskedastyczność</a></li>
<li class="chapter" data-level="13.2.5" data-path="part-13.html"><a href="part-13.html#part_13.2.5"><i class="fa fa-check"></i><b>13.2.5</b> Obserwacje odstające</a></li>
<li class="chapter" data-level="13.2.6" data-path="part-13.html"><a href="part-13.html#part_13.2.6"><i class="fa fa-check"></i><b>13.2.6</b> Metoda najmniejszych wartości bezwzględnych</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="part-13.html"><a href="part-13.html#part_13.3"><i class="fa fa-check"></i><b>13.3</b> Estymacja modelu nieliniowego</a><ul>
<li class="chapter" data-level="13.3.1" data-path="part-13.html"><a href="part-13.html#part_13.3.1"><i class="fa fa-check"></i><b>13.3.1</b> Model kwadratowy</a></li>
<li class="chapter" data-level="13.3.2" data-path="part-13.html"><a href="part-13.html#part_13.3.2"><i class="fa fa-check"></i><b>13.3.2</b> Model wykładniczy</a></li>
<li class="chapter" data-level="13.3.3" data-path="part-13.html"><a href="part-13.html#part_13.3.3"><i class="fa fa-check"></i><b>13.3.3</b> Model hiperboliczny</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="part-14.html"><a href="part-14.html"><i class="fa fa-check"></i><b>14</b> Zbiory danych</a><ul>
<li class="chapter" data-level="14.1" data-path="part-14.html"><a href="part-14.html#part_14.1"><i class="fa fa-check"></i><b>14.1</b> Zbiór danych GUSowskich</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bibliografia.html"><a href="bibliografia.html"><i class="fa fa-check"></i>Bibliografia</a></li>
<li class="divider"></li>
<li><a href="http://www.biecek.pl/NaPrzelajPrzezDataMining/" target="blank">strona projektu</a></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Na przełaj przez Data Mining z pakietem R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="part_7" class="section level1">
<h1><span class="header-section-number">Rozdział 7</span> Przykład analizy szeregów czasowych</h1>
<hr />
<div id="part_71" class="section level2">
<h2><span class="header-section-number">7.1</span> Wprowadzenie</h2>
<p>W skład szeregu czasowego mogą wchodzić następujące elementy:</p>
<ul>
<li><p>trend</p>
<ul>
<li><p>deterministyczny</p></li>
<li><p>stochastyczny</p></li>
</ul></li>
<li><p>wahania sezonowe</p>
<ul>
<li><p>addytywne</p></li>
<li><p>multiplikatywne</p></li>
</ul></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfcol=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>, <span class="dt">mgp=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="fl">0.6</span>,<span class="dv">0</span>),<span class="dt">las=</span><span class="dv">1</span>)
<span class="kw">plot</span>(<span class="kw">log</span>(AirPassengers),<span class="dt">col=</span><span class="st">&quot;SteelBlue&quot;</span>); <span class="kw">title</span>(<span class="st">&quot;addytywny&quot;</span>)
<span class="kw">plot</span>(AirPassengers,<span class="dt">col=</span><span class="st">&quot;SteelBlue&quot;</span>); <span class="kw">title</span>(<span class="st">&quot;multiplikatywwny&quot;</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:wy71"></span>
<img src="NaPrzelajR_files/figure-html/wy71-1.png" alt="Przykłady szeregów czasowych." width="100%" />
<p class="caption">
Rysunek 7.1: Przykłady szeregów czasowych.
</p>
</div>
<p>Wśród szeregów czasowych rozróżniamy dwa rodzaje procesów stochastycznych:
stacjonarne (w których nie występuje trend) oraz niestacjonarne (w których występuje trend). Aby wyeliminować tendencję rozwojową z danego procesu można
wykorzystać do tego celu różnicowanie:</p>
<ul>
<li>jednokrotne różnicowanie:</li>
</ul>
<p><span class="math display" id="eq:wz01">\[\begin{equation}
\Delta y_t=y_t-y_{t-1}
\tag{7.1}
\end{equation}\]</span></p>
<pre class="sourceCode r"><code class="sourceCode r">dy &lt;-<span class="st"> </span><span class="kw">diff</span>(AirPassengers)</code></pre>
<ul>
<li>dwukrotne różnicowanie:</li>
</ul>
<p><span class="math display" id="eq:wz02">\[\begin{equation}
\Delta\Delta y_t=y_t-y_{t-1}
\tag{7.2}
\end{equation}\]</span></p>
<pre class="sourceCode r"><code class="sourceCode r">ddy &lt;-<span class="st"> </span><span class="kw">diff</span>(AirPassengers, <span class="dt">lag=</span> <span class="dv">1</span>, <span class="dt">differences=</span> <span class="dv">2</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfcol=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>, <span class="dt">mgp=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="fl">0.6</span>,<span class="dv">0</span>),<span class="dt">las=</span><span class="dv">1</span>)
<span class="kw">plot</span>(<span class="kw">diff</span>(<span class="kw">log</span>(AirPassengers)),<span class="dt">col=</span><span class="st">&quot;SteelBlue&quot;</span>); <span class="kw">title</span>(<span class="st">&quot;addytywny&quot;</span>)
<span class="kw">plot</span>(<span class="kw">diff</span>(AirPassengers),<span class="dt">col=</span><span class="st">&quot;SteelBlue&quot;</span>); <span class="kw">title</span>(<span class="st">&quot;multiplikatywwny&quot;</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:wy72"></span>
<img src="NaPrzelajR_files/figure-html/wy72-1.png" alt="Przykłady jednokrotnego różnicowania szeregów czasowych." width="100%" />
<p class="caption">
Rysunek 7.2: Przykłady jednokrotnego różnicowania szeregów czasowych.
</p>
</div>
<p>W środowisku R dostępne są także funkcje dotyczące filtrowania szeregów czasowych. Jest to takie przekształcenie danych które doprowadza do oczyszczenia szeregu
czasowego z wahań periodycznych. W środowisku R dostępnych jest kilka takich
filtrów. Jeden z bardzie popularnych to filtr Hodrick-Prescotta zaimplementowany w pakiecie <a href="https://rdrr.io/cran/FRAPO/man/trdhp.html">FRAPO::trdhp</a>. Stosując filtr HP należy pamiętać o odpowiednim doborze parametru <span class="math inline">\(\lambda\)</span>. Hodrick oraz Prescott zalecają, aby wartość współczynnika <span class="math inline">\(\lambda\)</span> była równa 400, 1600 i 14400
odpowiednio dla danych rocznych, kwartalnych i miesięcznych.</p>
<pre class="sourceCode r"><code class="sourceCode r">f &lt;-<span class="st"> </span>FRAPO<span class="op">::</span><span class="kw">trdhp</span>(AirPassengers, <span class="dt">lambda=</span><span class="dv">14400</span>)

<span class="kw">par</span>(<span class="dt">mfcol=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>),<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>, <span class="dt">mgp=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="fl">0.6</span>,<span class="dv">0</span>),<span class="dt">las=</span><span class="dv">1</span>)
<span class="kw">plot</span>(AirPassengers,<span class="dt">col=</span><span class="st">&quot;SteelBlue&quot;</span>,
     <span class="dt">main=</span><span class="st">&quot;Hodrick-Prescott filter&quot;</span>)
<span class="kw">lines</span>(f,<span class="dt">col=</span><span class="st">&quot;YellowGreen&quot;</span>)
<span class="kw">plot</span>(AirPassengers<span class="op">-</span>f,<span class="dt">col=</span><span class="st">&quot;SteelBlue&quot;</span>,
     <span class="dt">main=</span><span class="st">&quot;Cyclical component (deviations from trend)&quot;</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:wy73"></span>
<img src="NaPrzelajR_files/figure-html/wy73-1.png" alt="Filtr Hodrick-Prescott." width="70%" />
<p class="caption">
Rysunek 7.3: Filtr Hodrick-Prescott.
</p>
</div>
<p>Dodajmy, że lepszą alternatywę dla procedury Hodricka-Prescotta zaproponował James D. Hamilton. Ten filtr został zaimplementowany do funkcji <a href="https://rdrr.io/cran/neverhpfilter/man/yth_filter.html">neverhpfilter::yth_filter</a>.</p>

</div>
<div id="part_72" class="section level2">
<h2><span class="header-section-number">7.2</span> Identyfikacja trendu i sezonowości</h2>
<div id="part_721" class="section level3">
<h3><span class="header-section-number">7.2.1</span> Analiza wariancji - ANOVA</h3>
<p>Ocena występowania trendu oraz wahań periodycznych zostanie dokonana na przykładzie miesięcznej stopy bezrobocia w Polsce w okresie od 01-2004 do 10-2010 roku.</p>
<pre class="sourceCode r"><code class="sourceCode r">b &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">20.6</span>, <span class="fl">20.6</span>, <span class="fl">20.4</span>, <span class="fl">19.9</span>, <span class="fl">19.5</span>, <span class="fl">19.4</span>, <span class="fl">19.3</span>, <span class="fl">19.1</span>, <span class="fl">18.9</span>, <span class="fl">18.7</span>, <span class="fl">18.7</span>, <span class="fl">19.0</span>, <span class="fl">19.4</span>, <span class="fl">19.4</span>, 
       <span class="fl">19.2</span>, <span class="fl">18.7</span>, <span class="fl">18.2</span>, <span class="fl">18.0</span>, <span class="fl">17.9</span>, <span class="fl">17.7</span>, <span class="fl">17.6</span>, <span class="fl">17.3</span>, <span class="fl">17.3</span>, <span class="fl">17.6</span>, <span class="fl">18.0</span>, <span class="fl">18.0</span>, <span class="fl">17.8</span>, <span class="fl">17.2</span>,
       <span class="fl">16.5</span>, <span class="fl">16.0</span>, <span class="fl">15.7</span>, <span class="fl">15.5</span>, <span class="fl">15.2</span>, <span class="fl">14.9</span>, <span class="fl">14.8</span>, <span class="fl">14.9</span>, <span class="fl">15.1</span>, <span class="fl">14.9</span>, <span class="fl">14.4</span>, <span class="fl">13.7</span>, <span class="fl">13.0</span>, <span class="fl">12.4</span>,
       <span class="fl">12.2</span>, <span class="fl">11.9</span>, <span class="fl">11.6</span>, <span class="fl">11.3</span>, <span class="fl">11.3</span>, <span class="fl">11.4</span>, <span class="fl">11.7</span>, <span class="fl">11.5</span>, <span class="fl">11.1</span>, <span class="fl">10.5</span>, <span class="fl">10.0</span>, <span class="fl">9.6</span>,  <span class="fl">9.40</span>, <span class="fl">9.10</span>,
       <span class="fl">8.90</span>, <span class="fl">8.80</span>, <span class="fl">9.10</span>, <span class="fl">9.50</span>, <span class="fl">10.5</span>, <span class="fl">10.9</span>, <span class="fl">11.2</span>, <span class="fl">11.0</span>, <span class="fl">10.8</span>, <span class="fl">10.7</span>, <span class="fl">10.8</span>, <span class="fl">10.8</span>, <span class="fl">10.9</span>, <span class="fl">11.1</span>,
       <span class="fl">11.4</span>, <span class="fl">11.9</span>, <span class="fl">12.7</span>, <span class="fl">13.0</span>, <span class="fl">12.9</span>, <span class="fl">12.3</span>, <span class="fl">11.9</span>, <span class="fl">10.6</span>, <span class="fl">10.7</span>, <span class="fl">11.4</span>, <span class="fl">11.5</span>)
b &lt;-<span class="st"> </span><span class="kw">ts</span>(b, <span class="dt">frequency =</span> <span class="dv">12</span>, <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">2004</span>, <span class="dv">1</span>))</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>, <span class="dt">mgp=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="fl">0.6</span>,<span class="dv">0</span>),<span class="dt">las=</span><span class="dv">1</span>)
<span class="kw">plot</span>(b,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="st">&quot;SteelBlue&quot;</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:wy74"></span>
<img src="NaPrzelajR_files/figure-html/wy74-1.png" alt="Stopa bezrobocia w Polsce od 01-2004 do 10-2010 roku." width="70%" />
<p class="caption">
Rysunek 7.4: Stopa bezrobocia w Polsce od 01-2004 do 10-2010 roku.
</p>
</div>
<pre class="sourceCode r"><code class="sourceCode r">T &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">2004</span>,<span class="dv">2005</span>,<span class="dv">2006</span>,<span class="dv">2007</span>,<span class="dv">2008</span>,<span class="dv">2009</span>,<span class="dv">2010</span>),<span class="kw">c</span>(<span class="dv">12</span>,<span class="dv">12</span>,<span class="dv">12</span>,<span class="dv">12</span>,<span class="dv">12</span>,<span class="dv">12</span>,<span class="dv">9</span>))
T &lt;-<span class="st"> </span><span class="kw">factor</span>(T)
S &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>,<span class="dv">7</span>);S=S[<span class="op">-</span><span class="kw">c</span>(<span class="dv">82</span><span class="op">:</span><span class="dv">84</span>)]
S &lt;-<span class="st"> </span><span class="kw">factor</span>(S)</code></pre>
<p>Identyfikację szeregu czasowego można przeprowadzić na kilka sposobów. Jednym z
nich jest analiza wariancji ANOVA.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(<span class="kw">lm</span>(b<span class="op">~</span>T<span class="op">+</span>S))</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Response: b
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## T          6 990.99 165.165 523.410 &lt; 2.2e-16 ***
## S         11  51.67   4.697  14.886  1.13e-13 ***
## Residuals 63  19.88   0.316                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Na podstawie przeprowadzonej analizie wariancji, należy stwierdzić, że w omawianym szeregu czasowym występuje trend (p-value = 2.2e-16). W celu dokonania
dalszej identyfikacji szeregu (oceny występowania sezonowości) należy wyeliminować
tendencję rozwojową (np. poprzez różnicowanie).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(<span class="kw">lm</span>(<span class="kw">diff</span>(b)<span class="op">~</span>T[<span class="op">-</span><span class="dv">1</span>]<span class="op">+</span>S[<span class="op">-</span><span class="dv">1</span>]))</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Response: diff(b)
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## T[-1]      6 1.7879 0.29798  8.1625 1.617e-06 ***
## S[-1]     11 6.8836 0.62578 17.1420 6.600e-15 ***
## Residuals 62 2.2634 0.03651                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Jednokrotne różnicowanie szeregu nie przyniosło porządanego efektu (p-value =
1.617e-06). Zatem powinniśmy badany szereg poddać dwukrotnemu różnicowaniu. Należy tę procedurę powtarzać, aż do skutku czyli wyeliminowamia trendu.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(<span class="kw">lm</span>(<span class="kw">diff</span>(b,<span class="dv">1</span>,<span class="dv">2</span>)<span class="op">~</span>T[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]<span class="op">+</span>S[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]))</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Response: diff(b, 1, 2)
##             Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## T[-c(1, 2)]  6 0.0383 0.00639  0.1030    0.9958    
## S[-c(1, 2)] 11 4.3495 0.39541  6.3775 6.621e-07 ***
## Residuals   61 3.7820 0.06200                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Dopiero dwukrotne różnicowanie przyniosło porządany efekt (p-value = 0.9958). Tak
więc teraz możemy stwierdzić, że w badanym szeregu czasowym występuje sezonowość (p-value = 6.621e-07).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(<span class="kw">lm</span>(b<span class="op">~</span>T<span class="op">+</span>S))</code></pre>
<pre><code>## 
## Call:
## lm(formula = b ~ T + S)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.75126 -0.20245  0.02639  0.19755  1.45139 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 20.75959    0.26044  79.710  &lt; 2e-16 ***
## T2005       -1.31667    0.22933  -5.741 2.91e-07 ***
## T2006       -3.30000    0.22933 -14.390  &lt; 2e-16 ***
## T2007       -6.74167    0.22933 -29.397  &lt; 2e-16 ***
## T2008       -9.57500    0.22933 -41.752  &lt; 2e-16 ***
## T2009       -8.50833    0.22933 -37.101  &lt; 2e-16 ***
## T2010       -7.87546    0.25064 -31.422  &lt; 2e-16 ***
## S2           0.04286    0.30026   0.143 0.886958    
## S3          -0.14286    0.30026  -0.476 0.635883    
## S4          -0.67143    0.30026  -2.236 0.028894 *  
## S5          -1.15714    0.30026  -3.854 0.000275 ***
## S6          -1.61429    0.30026  -5.376 1.18e-06 ***
## S7          -1.71429    0.30026  -5.709 3.29e-07 ***
## S8          -1.78571    0.30026  -5.947 1.31e-07 ***
## S9          -1.91429    0.30026  -6.375 2.42e-08 ***
## S10         -2.16931    0.31386  -6.912 2.85e-09 ***
## S11         -2.08598    0.31386  -6.646 8.23e-09 ***
## S12         -1.80265    0.31386  -5.744 2.88e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.5617 on 63 degrees of freedom
## Multiple R-squared:  0.9813, Adjusted R-squared:  0.9762 
## F-statistic: 194.4 on 17 and 63 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Oszacowane współczynniki regresji liniowej wskazują jakie są różnice między średnimi stapami bezrobocia w poszczególnych latach oraz miesiącach. Punktem referencyjnym dla czynnika <code>T</code> jest 2004 rok, dla <code>S</code> styczeń. Aby zmienić punkt odniesienia np. na rok 2005 wystarczy wykonać komendę:</p>
<pre class="sourceCode r"><code class="sourceCode r">T =<span class="st"> </span><span class="kw">relevel</span>(T, <span class="dt">ref=</span><span class="st">&quot;2005&quot;</span>)</code></pre>
<p>a następnie przeprowadzić regresję. Jeśli chcemy wyznaczyć średnie stopy bezrobocia
w poszczególnych latach trzeba skorzystać z funkcji <a href="https://rdrr.io/r/base/tapply.html">tapply</a>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tapply</span>(b,T,mean)</code></pre>
<pre><code>##      2005      2004      2006      2007      2008      2009      2010 
## 18.191667 19.508333 16.208333 12.766667  9.933333 11.000000 11.888889</code></pre>
<p>Prezentację graficzną kształtowania się średnich możemy wykonać w następujący
sposób:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfcol=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>, <span class="dt">mgp=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="fl">0.6</span>,<span class="dv">0</span>),<span class="dt">las=</span><span class="dv">1</span>)
<span class="kw">interaction.plot</span>(T,S,b,<span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">12</span>,<span class="dt">lwd=</span><span class="dv">2</span>)
<span class="kw">interaction.plot</span>(S,T,b,<span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">7</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:wy75"></span>
<img src="NaPrzelajR_files/figure-html/wy75-1.png" alt="Średnie dla miesięcy i lat." width="100%" />
<p class="caption">
Rysunek 7.5: Średnie dla miesięcy i lat.
</p>
</div>
</div>
<div id="part_722" class="section level3">
<h3><span class="header-section-number">7.2.2</span> Funkcja autokorelacji - ACF</h3>
<p>Do identyfikacji składowych szeregu czasowego (trendu oraz sezonowości) można
również wykorzystać funkcję autokorelacji - ACF. W środowisku R jest dostępna
funkcja graficzna <a href="https://rdrr.io/github/robjhyndman/forecast/man/tsdisplay.html"><code>forecast::tsdisplay</code></a>, za pomocą której zostają wygenerowane
trzy wykresy: krzywa badanego zjawiska, funkcja autokorelacji ACF oraz funkcja
częściowej autokorelacji PACF.</p>
<pre class="sourceCode r"><code class="sourceCode r">forecast<span class="op">::</span><span class="kw">tsdisplay</span>(b,<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">las=</span><span class="dv">1</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:wy76"></span>
<img src="NaPrzelajR_files/figure-html/wy76-1.png" alt="Funkcja ACF oraz PACF." width="70%" />
<p class="caption">
Rysunek 7.6: Funkcja ACF oraz PACF.
</p>
</div>
<p>Ponieważ funkcja autokorelacji ACF maleje wykładniczo wraz ze wzrostem parametru <span class="math inline">\(p\)</span> (rys. <a href="part-7.html#fig:wy76">7.6</a>) należy sądzić, że w badanym procesie występuje trend.</p>
<pre class="sourceCode r"><code class="sourceCode r">forecast<span class="op">::</span><span class="kw">tsdisplay</span>(<span class="kw">diff</span>(b),<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">las=</span><span class="dv">1</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:wy77"></span>
<img src="NaPrzelajR_files/figure-html/wy77-1.png" alt="Funkcja ACF oraz PACF dla pierwszych różnic." width="70%" />
<p class="caption">
Rysunek 7.7: Funkcja ACF oraz PACF dla pierwszych różnic.
</p>
</div>
<p>Po zastosowaniu funkcji różnicowania szeregu czasowego trend został wyeliminowany a funkcja ACF wskazuje na występowanie miesięcznych wahań sezonowych
(rys. <a href="part-7.html#fig:wy77">7.7</a>).</p>
<p>Zatem na podstawie analizy ANOVA oraz funkcji ACF doszliśmy do wniosku,
że badany szereg czasowy charakteryzuje się trendem oraz sezonowością. Również
dzięki funkcji <a href="https://rdrr.io/r/stats/stl.html"><code>stl</code></a> za pomocą której dokonaliśmy dekompozycji badanego
procesu (rys. <a href="part-7.html#fig:wy78">7.8</a>) możemy potwierdzić występowanie tendencji rozwojowej oraz
wahań periodycznych.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">stl</span>(b,<span class="dt">s.window=</span><span class="st">&quot;periodic&quot;</span>),<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:wy78"></span>
<img src="NaPrzelajR_files/figure-html/wy78-1.png" alt="Dekompozycja szeregu czasowego." width="70%" />
<p class="caption">
Rysunek 7.8: Dekompozycja szeregu czasowego.
</p>
</div>

</div>
</div>
<div id="part_73" class="section level2">
<h2><span class="header-section-number">7.3</span> Modele autoregresyjne ARIMA</h2>
<p>Modele <span class="math inline">\(ARIMA\)</span> służą do analizy stacjonarnych szeregów czasowych. W przypadku
gdy szereg jest niestacjonarny należy sprowadzić go do stacjonarności np. poprzez
różnicowanie. W skład modelu <span class="math inline">\(ARIMA(p, d, q)\)</span> mogą wchodzić następujące elementy:</p>
<ul>
<li><p><span class="math inline">\(AR(p)\)</span> – autoregresja (rząd opóźnienia <span class="math inline">\(p\)</span>)</p></li>
<li><p><span class="math inline">\(I(d)\)</span> – stopień integracji szeregu (krotność różnicowania <span class="math inline">\(d\)</span>)</p></li>
<li><p><span class="math inline">\(MA(q)\)</span> – średnia ruchoma (rząd opóźnienia <span class="math inline">\(q\)</span>)</p></li>
</ul>
<p>Z kolei gdy w badanym procesie występuje sezonowość należy estymować model o
postaci <span class="math inline">\(SARIMA(p, d, q)(P, D, Q)_m\)</span> gdzie:</p>
<ul>
<li><p><span class="math inline">\(m\)</span> – sezonowość (np. dla <span class="math inline">\(m = 4\)</span> sezonowość kwartalna)</p></li>
<li><p><span class="math inline">\(P\)</span> – autoregresja sezonowa</p></li>
<li><p><span class="math inline">\(D\)</span> – integracja sezonowa</p></li>
<li><p><span class="math inline">\(Q\)</span> – średnia ruchoma sezonowa</p></li>
</ul>
<p>Prawie każdy model <span class="math inline">\(ARIMA\)</span> można zapisać w dwojaki sposób np dla procesu <span class="math inline">\(y_t\)</span>:</p>
<ul>
<li><span class="math inline">\(ARIMA(2,0,0)\)</span> czyli <span class="math inline">\(AR(2)\)</span>:</li>
</ul>
<p><span class="math display" id="eq:ar01">\[\begin{equation}
y_t= \alpha_1 y_{t-1}+\alpha_2 y_{t-2}+\epsilon_t
\tag{7.3}
\end{equation}\]</span></p>
<ul>
<li><span class="math inline">\(ARIMA(2,0,1)\)</span> czyli <span class="math inline">\(ARMA(2,1)\)</span>:</li>
</ul>
<p><span class="math display" id="eq:ar02">\[\begin{equation}
y_t= \alpha_1 y_{t-1}+\alpha_2 y_{t-2}-\beta_1 \epsilon_{t-1}+\epsilon_t
\tag{7.4}
\end{equation}\]</span></p>
<ul>
<li><span class="math inline">\(ARIMA(2,1,0)\)</span> czyli <span class="math inline">\(ARI(2,1)\)</span>:</li>
</ul>
<p><span class="math display" id="eq:ar03">\[\begin{equation}
\Delta y_t= \alpha_1\Delta y_{t-1}+\alpha_2\Delta y_{t-2} +\epsilon_t
\tag{7.5}
\end{equation}\]</span></p>
<ul>
<li><span class="math inline">\(SARIMA(1,0,0)(2,0,0)_4\)</span> czyli <span class="math inline">\(SARI(1)(2)_4\)</span>:</li>
</ul>
<p><span class="math display" id="eq:ar04">\[\begin{equation}
y_t= \alpha_1 y_{t-1}+\alpha_2 y_{t-4}+\alpha_3 y_{t-8} +\epsilon_t
\tag{7.6}
\end{equation}\]</span></p>
<p>Środowisko R dostarcza wiele funkcji za pomocą których możemy estymować
modele typu <span class="math inline">\(ARIMA\)</span>. Przykładowo komenda <a href="https://rdrr.io/r/stats/ar.html">ar</a> daje możliwość estymacji modeli autoregresyjnych <span class="math inline">\(AR(p)\)</span>. Opcja method oferuje kilka sposobów szacowania
parametrów modelu: <code>burg</code>, <code>ols</code>, <code>mle</code>, <code>yule-walker</code>, <code>yw</code>. Z kolei funkcja <a href="https://rdrr.io/r/stats/arima.html"><code>arima</code></a> służy do estymacji modeli <span class="math inline">\(ARIMA\)</span> lub <span class="math inline">\(SARIMA\)</span>. Warto także
zwrócić uwagę na pakiet <a href="https://rdrr.io/cran/forecast/"><code>forecast</code></a> który dostarcza szereg funkcji do analizy szeregów czasowych.</p>
<div id="part_731" class="section level3">
<h3><span class="header-section-number">7.3.1</span> Estymacja</h3>
<p>Wykorzystując funkcje <a href="https://rdrr.io/cran/forecast/man/auto.arima.html"><code>forecast::auto.arima</code></a> proces estymacji modelu <code>ARIMA</code>
przebiega w sposób całkowicie automatyczny. Spośród wielu estymowanych modeli zostaje wybrany ten, który charakteryzuje się najmniejszą wartością kryterium
informacyjnego AIC – opcja domyślna. W poniższym przykładzie założymy stałą wartość parametru różnicowania <span class="math inline">\(d=1\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span>forecast<span class="op">::</span><span class="kw">auto.arima</span>(b,<span class="dt">d=</span><span class="dv">1</span>)
<span class="kw">summary</span>(m)</code></pre>
<pre><code>## Series: b 
## ARIMA(1,1,1)(0,1,0)[12] 
## 
## Coefficients:
##          ar1      ma1
##       0.7948  -0.3710
## s.e.  0.1172   0.1851
## 
## sigma^2 estimated as 0.05246:  log likelihood=4.58
## AIC=-3.16   AICc=-2.78   BIC=3.5
## 
## Training set error measures:
##                       ME      RMSE       MAE       MPE      MAPE
## Training set 0.008136148 0.2067496 0.1162358 0.1296337 0.9846707
##                    MASE       ACF1
## Training set 0.05684101 0.02321908</code></pre>
<p>Oczywiście można samemu założyć liczbę wszystkich parametrów <span class="math inline">\(p\)</span>, <span class="math inline">\(d\)</span>, <span class="math inline">\(q\)</span>, <span class="math inline">\(P\)</span> , <span class="math inline">\(D\)</span>, <span class="math inline">\(Q\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="kw">arima</span>(b,<span class="dt">order=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="dt">seasonal=</span><span class="kw">list</span>(<span class="dt">order=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">period=</span><span class="dv">12</span>))
<span class="kw">summary</span>(m)</code></pre>
<pre><code>## 
## Call:
## arima(x = b, order = c(1, 1, 0), seasonal = list(order = c(1, 0, 0), period = 12))
## 
## Coefficients:
##          ar1    sar1
##       0.5580  0.7313
## s.e.  0.0912  0.0834
## 
## sigma^2 estimated as 0.04792:  log likelihood = 3.24,  aic = -0.48
## 
## Training set error measures:
##                        ME      RMSE       MAE        MPE     MAPE
## Training set -0.007606623 0.2175572 0.1379808 0.02153749 1.097891
##                   MASE         ACF1
## Training set 0.4505497 -0.006360661</code></pre>
<p>Warto również zaznaczyć, że w programie R mamy możliwość symulowania procesów autoregresji.</p>
<pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span><span class="kw">arima.sim</span>( <span class="dt">n=</span><span class="dv">1000</span>,
                <span class="dt">innov=</span><span class="kw">rnorm</span>(<span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">2</span>), <span class="co"># składnik losowy ma rozkład N(0,2)</span>
                <span class="dt">model=</span><span class="kw">list</span>(
                  <span class="dt">order =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="co"># ilość parametrów</span>
                  <span class="dt">ar =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.6</span>), <span class="co"># wartości parametrów p</span>
                  <span class="dt">ma =</span> <span class="kw">c</span>( <span class="fl">0.2</span>),     <span class="co"># wartości parametrów q</span>
                  <span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="fl">0.1</span>)))</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>, <span class="dt">mgp=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="fl">0.6</span>,<span class="dv">0</span>),<span class="dt">las=</span><span class="dv">1</span>)
<span class="kw">plot</span>(<span class="kw">ts</span>(y),<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="st">&quot;SteelBlue&quot;</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:wy79"></span>
<img src="NaPrzelajR_files/figure-html/wy79-1.png" alt="Prezentacja graficzna symulowanego procesu." width="70%" />
<p class="caption">
Rysunek 7.9: Prezentacja graficzna symulowanego procesu.
</p>
</div>
<pre class="sourceCode r"><code class="sourceCode r">s &lt;-<span class="st"> </span><span class="kw">arima</span>(y,<span class="dt">order=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>))
s</code></pre>
<pre><code>## 
## Call:
## arima(x = y, order = c(2, 1, 1))
## 
## Coefficients:
##          ar1     ar2     ma1
##       0.2628  0.6446  0.2593
## s.e.  0.0533  0.0466  0.0700
## 
## sigma^2 estimated as 4.158:  log likelihood = -2132.41,  aic = 4272.81</code></pre>
<p>Dzięki zastosowaniu funkcji <a href="https://rdrr.io/cran/forecast/man/ndiffs.html"><code>forecast::ndiffs</code></a> mamy możliwość sprawdzenia czy rzeczywiście proces y jest zintegrowany w stopniu pierwszym tzn. <span class="math inline">\(I(1)\)</span>. Za pomocą opcji test możemy wybrać procedurę z jakiej chcemy skorzystać: <code>pp</code> – test Phillipsa-Perrona, <code>adf</code> – test Dickeya-Fullera lub <code>kpss</code> – test Kwiatkowski-Phillips-Schmidt-Shin. Poziom istotności <code>alpha</code> także możemy zmieniać.</p>
<pre class="sourceCode r"><code class="sourceCode r">forecast<span class="op">::</span><span class="kw">ndiffs</span>(y,<span class="dt">test=</span><span class="st">&quot;pp&quot;</span>,<span class="dt">alpha=</span><span class="fl">0.05</span>)</code></pre>
<pre><code>## [1] 1</code></pre>
<p>Wynikiem funkcji <a href="https://rdrr.io/cran/forecast/man/ndiffs.html"><code>forecast::ndiffs</code></a> zawsze jest stopień zintegrowania badanego
procesu. Zatem należy stwierdzić, że w zmiennej <span class="math inline">\(y\)</span> występuje pierwiastek jednostkowy <span class="math inline">\(d = 1\)</span>.</p>
</div>
<div id="part_732" class="section level3">
<h3><span class="header-section-number">7.3.2</span> Weryfikacja</h3>
<p>Etap weryfikacji oszacowanego modelu <span class="math inline">\(ARIMA\)</span> polega na sprawdzeniu hipotezy zerowej o braku zjawiska autokorelacji w procesie reszt. Do tego celu możemy wykorzystać test Ljunga-Boxa.</p>
<pre class="sourceCode r"><code class="sourceCode r">r &lt;-<span class="st"> </span><span class="kw">resid</span>(m)
p &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="cf">function</span>(i) <span class="kw">Box.test</span>(r, i, <span class="dt">type =</span> <span class="st">&quot;Ljung-Box&quot;</span>)<span class="op">$</span>p.value)
p</code></pre>
<pre><code>##  [1] 0.9535022 0.9152975 0.5318782 0.6333194 0.7667281 0.8522917 0.8863058
##  [8] 0.9348725 0.9625130 0.9775571</code></pre>
<p>Tak więc na podstawie testu Ljunga-Boxa brak jest podstaw do odrzucenia hipotezy
zerowej zakładającej brak autokorelacji. Wniosek ten potwierdzają również wykresy
wykonane za pomocą komendy <a href="https://rdrr.io/r/stats/tsdiag.html"><code>tsdiag</code></a> (rys. <a href="part-7.html#fig:wy80">7.10</a>).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>, <span class="dt">mgp=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="fl">0.6</span>,<span class="dv">0</span>),<span class="dt">las=</span><span class="dv">1</span>)
<span class="kw">tsdiag</span>(m)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:wy80"></span>
<img src="NaPrzelajR_files/figure-html/wy80-1.png" alt="Diagnostyka reszt modelu." width="70%" />
<p class="caption">
Rysunek 7.10: Diagnostyka reszt modelu.
</p>
</div>
</div>
<div id="part_733" class="section level3">
<h3><span class="header-section-number">7.3.3</span> Prognozowanie</h3>
<p>Funkcja <a href="https://rdrr.io/cran/forecast/man/forecast.html"><code>forecast::forecast</code></a> służy do obliczania prognoz na podstawie danego
modelu. W naszym przykładzie liczbę okresów do prognozowania została ustalona
na <span class="math inline">\(12\)</span> miesięcy. Natomiast przedziały predykcji zostały ustalone na poziomie 80%
i <span class="math inline">\(95\%\)</span> – są to wartości domyślne. Gdybyśmy chcieli je zmienić na <span class="math inline">\(99\%\)</span> wystarczy użyć polecenia <code>level=99</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">forecast<span class="op">::</span><span class="kw">forecast</span>(m,<span class="dt">h=</span><span class="dv">12</span>)</code></pre>
<pre><code>##          Point Forecast     Lo 80    Hi 80     Lo 95    Hi 95
## Oct 2010       11.66125 11.380716 11.94178 11.232211 12.09029
## Nov 2010       11.88899 11.369636 12.40835 11.094703 12.68329
## Dec 2010       12.25929 11.521215 12.99738 11.130499 13.38809
## Jan 2011       12.84691 11.912406 13.78141 11.417711 14.27611
## Feb 2011       13.06774 11.956998 14.17848 11.369006 14.76648
## Mar 2011       12.99543 11.725520 14.26533 11.053272 14.93758
## Apr 2011       12.55712 11.142176 13.97207 10.393148 14.72110
## May 2011       12.26487 10.716515 13.81323  9.896864 14.63288
## Jun 2011       11.31437  9.642230 12.98652  8.757050 13.87170
## Jul 2011       11.38758  9.599679 13.17548  8.653222 14.12194
## Aug 2011       11.89950 10.002628 13.79638  8.998482 14.80053
## Sep 2011       11.97266  9.972585 13.97273  8.913812 15.03150</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>, <span class="dt">mgp=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="fl">0.6</span>,<span class="dv">0</span>),<span class="dt">las=</span><span class="dv">1</span>)
<span class="kw">plot</span>(forecast<span class="op">::</span><span class="kw">forecast</span>(m,<span class="dt">h=</span><span class="dv">12</span>))</code></pre>
<div class="figure" style="text-align: center"><span id="fig:wy81"></span>
<img src="NaPrzelajR_files/figure-html/wy81-1.png" alt="Prognoza stopy bezrobocia od 10.2010–09.2011." width="70%" />
<p class="caption">
Rysunek 7.11: Prognoza stopy bezrobocia od 10.2010–09.2011.
</p>
</div>
<p>Dodatkowo możemy wyznaczyć błędy prognoz za pomocą funkcji <a href="https://rdrr.io/r/stats/predict.lm.html"><code>predict</code></a>:</p>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">predict</span>(m,<span class="dt">n.ahead=</span><span class="dv">12</span>)
<span class="kw">ts</span>( <span class="kw">cbind</span>(<span class="dt">pred=</span>p<span class="op">$</span>pred, <span class="dt">se=</span>p<span class="op">$</span>se, <span class="dt">error=</span>p<span class="op">$</span>se<span class="op">/</span>p<span class="op">$</span>pred), <span class="dt">start=</span><span class="kw">c</span>(<span class="dv">2010</span>,<span class="dv">10</span>),<span class="dt">freq=</span><span class="dv">12</span>)</code></pre>
<pre><code>##              pred        se      error
## Oct 2010 11.66125 0.2189006 0.01877162
## Nov 2010 11.88899 0.4052582 0.03408683
## Dec 2010 12.25929 0.5759270 0.04697881
## Jan 2011 12.84691 0.7291963 0.05676045
## Feb 2011 13.06774 0.8667176 0.06632497
## Mar 2011 12.99543 0.9909135 0.07625094
## Apr 2011 12.55712 1.1040891 0.08792532
## May 2011 12.26487 1.2081893 0.09850810
## Jun 2011 11.31437 1.3047811 0.11532066
## Jul 2011 11.38758 1.3951054 0.12251115
## Aug 2011 11.89950 1.4801411 0.12438678
## Sep 2011 11.97266 1.5606634 0.13035232</code></pre>
<p>Otrzymane wartości prognostyczne wskazują, iż należy się spodziewać wzrostu stopy
bezrobocia od października <span class="math inline">\(2010\)</span>–<span class="math inline">\(11,66\%\)</span> do lutego 2011–<span class="math inline">\(13,07\%\)</span>. Od marca
należy się spodziewać spadku tego wskaźnika do poziomu <span class="math inline">\(11,31\%\)</span> w czerwcu <span class="math inline">\(2011\)</span>
roku. Następnie będzie on znów powoli wzrastał i w miesiącu wrześniu osiągnie
wartość <span class="math inline">\(11,97\%\)</span>. Należy także zwrócic uwagę na oszacowane błędy otrzymanych
prognoz. Dla października 2010 wyniósł on <span class="math inline">\(1,9\%\)</span> i cały czas wzrastał, aż do poziomu <span class="math inline">\(13,04\%\)</span> dla września <span class="math inline">\(2011\)</span> roku.</p>

</div>
</div>
<div id="part_74" class="section level2">
<h2><span class="header-section-number">7.4</span> Modele adaptacyjne</h2>
<div id="part_741" class="section level3">
<h3><span class="header-section-number">7.4.1</span> Estymacja</h3>
<p>Podobnie jak w przypadku modelu <span class="math inline">\(ARIMA\)</span> także estymacja modelu adaptacyjnego
może przebiegać w sposób całkowicie automatyczny. Wykorzystamy do tego celu
funkcje <a href="https://rdrr.io/cran/forecast/man/ets.html"><code>forecast::ets</code></a>.</p>
<pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span>forecast<span class="op">::</span><span class="kw">ets</span>(b,<span class="dt">model=</span><span class="st">&quot;ZZZ&quot;</span>,<span class="dt">damped=</span><span class="ot">NULL</span>)
<span class="kw">summary</span>(n)</code></pre>
<pre><code>## ETS(A,Ad,A) 
## 
## Call:
##  forecast::ets(y = b, model = &quot;ZZZ&quot;, damped = NULL) 
## 
##   Smoothing parameters:
##     alpha = 0.9978 
##     beta  = 0.132 
##     gamma = 0.0016 
##     phi   = 0.9752 
## 
##   Initial states:
##     l = 19.8288 
##     b = -0.0952 
##     s = 0.0294 -0.3797 -0.5833 -0.4821 -0.3923 -0.3453
##            -0.3235 -0.0403 0.3291 0.7522 0.7916 0.6442
## 
##   sigma:  0.2251
## 
##      AIC     AICc      BIC 
## 131.2611 142.2934 174.3612 
## 
## Training set error measures:
##                        ME     RMSE       MAE        MPE     MAPE
## Training set -0.003431383 0.200049 0.1258755 0.05990526 1.004237
##                    MASE      ACF1
## Training set 0.06155499 0.2850916</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">logLik</span>(n) <span class="co"># logarytm wiarygodności</span></code></pre>
<pre><code>## &#39;log Lik.&#39; -47.63055 (df=18)</code></pre>
<p>Spośród wszystkich modeli, które były estymowane – <code>model=&quot;ZZZ&quot;</code> z wykorzystaniem optymalizacji logarytmu wiarygodności – <code>opt.crit=&quot;lik&quot;</code>, został wybrany
model o najmniejszym kryterium informacyjnym AIC – <code>ic=&quot;aic&quot;</code>. Dostępne są
także inne metody optymalizacyjne do szacowania parametrów: <code>mse</code>, <code>amse</code>, <code>nmse</code>,
<code>sigma</code>. Także wybór kryterium informacyjnego (za pomocą którego dokonujemy
wyboru najlepszego modelu) możemy wybrać samodzielnie: <code>aic</code>, <code>aicc</code>, <code>bic</code>. Tak
przeprowadzona estymacja doprowadziła do otrzymania modelu <code>&quot;AAdA&quot;</code>, który charakteryzuje się następującymi cechami: <code>A</code> – addytywny składnik losowy (pierwsza
litera), <code>Ad</code> – trend addytywny (druga litera), gdzie mała litera d oznacza, że została wybrana również opcja <code>damped=T</code> czyli “przygaszenie” trendu, <code>A</code> – addytywne
wachania sezonowe (trzecia litera). Zatem otrzymaliśmy model Wintersa z addytywnymi wahaniami periodycznymi:</p>
<pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span>forecast<span class="op">::</span><span class="kw">ets</span>(b, <span class="dt">model=</span><span class="st">&quot;AAA&quot;</span>)
n</code></pre>
<pre><code>## ETS(A,Ad,A) 
## 
## Call:
##  forecast::ets(y = b, model = &quot;AAA&quot;) 
## 
##   Smoothing parameters:
##     alpha = 0.9978 
##     beta  = 0.132 
##     gamma = 0.0016 
##     phi   = 0.9752 
## 
##   Initial states:
##     l = 19.8288 
##     b = -0.0952 
##     s = 0.0294 -0.3797 -0.5833 -0.4821 -0.3923 -0.3453
##            -0.3235 -0.0403 0.3291 0.7522 0.7916 0.6442
## 
##   sigma:  0.2251
## 
##      AIC     AICc      BIC 
## 131.2611 142.2934 174.3612</code></pre>
<p>Oczywiście korzystając z funkcji <a href="https://rdrr.io/cran/forecast/man/ets.html"><code>forecast::ets</code></a> oraz opcji <code>model</code> możemy od razu zawęzić
grupę modeli, spośród których zostanie wybrany najlepszy z nich: modele Browna
– <code>model=&quot;ZNN&quot;</code>, modele Browna lub Holta – <code>model=&quot;ZZN&quot;</code>, modele Browna, Holta
lub Wintersa – <code>model=&quot;ZZZ&quot;</code>. Jest również możliwość estymacji modeli o ustalonych
parametrach: <code>alpha</code>, <code>beta</code>, <code>gamma</code>, <code>phi</code>. Natomiast gdy ich wartości zawierają się
w pewnych przedziałach liczbowych, przykładowo jeśli <span class="math inline">\(\alpha = (0,11 - 0,53)\)</span>, <span class="math inline">\(\beta = (0,41 - 0,68)\)</span> i <span class="math inline">\(\gamma = (0,65 - 0,78)\)</span> to należy użyć opcji <code>level=c(0.11,0.41,0.65)</code> oraz <code>upper=c(0.53,0.68,0.78)</code>.</p>
</div>
<div id="part_742" class="section level3">
<h3><span class="header-section-number">7.4.2</span> Prognozowanie</h3>
<p>Do procesu prognozowania z wykorzystaniem modelu adaptacyjnego możemy również wykorzystać funkcję <a href="https://rdrr.io/cran/forecast/man/forecast.html"><code>forecast::forecast</code></a>.</p>
<pre class="sourceCode r"><code class="sourceCode r">forecast<span class="op">::</span><span class="kw">forecast</span>(n,<span class="dt">h=</span><span class="dv">12</span>)</code></pre>
<pre><code>##          Point Forecast    Lo 80    Hi 80     Lo 95    Hi 95
## Oct 2010       11.45805 11.16963 11.74646 11.016945 11.89914
## Nov 2010       11.71903 11.28458 12.15348 11.054594 12.38346
## Dec 2010       12.18460 11.61967 12.74953 11.320617 13.04858
## Jan 2011       12.85520 12.16506 13.54533 11.799728 13.91066
## Feb 2011       13.05585 12.24227 13.86942 11.811592 14.30010
## Mar 2011       13.06843 12.13164 14.00522 11.635734 14.50113
## Apr 2011       12.69693 11.63640 13.75747 11.074992 14.31888
## May 2011       12.37728 11.19211 13.56246 10.564716 14.18985
## Jun 2011       12.14212 10.83122 13.45302 10.137273 14.14697
## Jul 2011       12.16889 10.73111 13.60667  9.969991 14.36778
## Aug 2011       12.16869 10.60287 13.73452  9.773968 14.56341
## Sep 2011       12.12366 10.42866 13.81867  9.531375 14.71595</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>, <span class="dt">mgp=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="fl">0.6</span>,<span class="dv">0</span>),<span class="dt">las=</span><span class="dv">1</span>)
<span class="kw">plot</span>(forecast<span class="op">::</span><span class="kw">forecast</span>(n,<span class="dt">h=</span><span class="dv">12</span>))</code></pre>
<div class="figure" style="text-align: center"><span id="fig:wy82"></span>
<img src="NaPrzelajR_files/figure-html/wy82-1.png" alt="Prognoza stopy bezrobocia od 10.2010–09.2011." width="70%" />
<p class="caption">
Rysunek 7.12: Prognoza stopy bezrobocia od 10.2010–09.2011.
</p>
</div>
<p>W przypadku gdy wykonaliśmy dwie prognozy za pomocą różnych modeli (np.
modelu <span class="math inline">\(ARIMA\)</span> i adaptacyjnego) warto skorzystać z testu Diebold-Mariano. Hipoteza zerowa tego tesu zakłada, że dokładność predykcyjna dwóch modeli jest jednakowa. Założenie <code>alt=&quot;two.sided&quot;</code> (test dwustronny) jest opcją domyślną, możemy
ją zmienić dodając polecenie <code>alt=&quot;g&quot;</code> (test prawostronny) lub <code>alt=&quot;l&quot;</code> (test lewostronny).</p>
<pre class="sourceCode r"><code class="sourceCode r">forecast<span class="op">::</span><span class="kw">dm.test</span>(<span class="kw">resid</span>(m),<span class="kw">resid</span>(n))</code></pre>
<pre><code>## 
##  Diebold-Mariano Test
## 
## data:  resid(m)resid(n)
## DM = 1.0538, Forecast horizon = 1, Loss function power = 2,
## p-value = 0.2951
## alternative hypothesis: two.sided</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="part-6.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="part-8.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["NaPrzelajR.pdf", "NaPrzelajR.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
